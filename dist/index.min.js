!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@babel/runtime-corejs3/core-js-stable/instance/for-each"),require("@babel/runtime-corejs3/core-js-stable/instance/concat"),require("@babel/runtime-corejs3/helpers/classCallCheck"),require("@babel/runtime-corejs3/helpers/createClass"),require("@babel/runtime-corejs3/helpers/defineProperty"),require("@babel/runtime-corejs3/regenerator"),require("@babel/runtime-corejs3/core-js-stable/set-timeout"),require("@babel/runtime-corejs3/core-js-stable/promise"),require("@babel/runtime-corejs3/core-js-stable/instance/slice"),require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-names"),require("@babel/runtime-corejs3/helpers/asyncToGenerator"),require("@babel/runtime-corejs3/core-js-stable/instance/splice"),require("@babel/runtime-corejs3/core-js-stable/instance/index-of"),require("@babel/runtime-corejs3/helpers/toConsumableArray"),require("@babel/runtime-corejs3/core-js-stable/map"),require("@babel/runtime-corejs3/core-js-stable/instance/bind"),require("@babel/runtime-corejs3/core-js-stable/object/create")):"function"==typeof define&&define.amd?define(["@babel/runtime-corejs3/core-js-stable/instance/for-each","@babel/runtime-corejs3/core-js-stable/instance/concat","@babel/runtime-corejs3/helpers/classCallCheck","@babel/runtime-corejs3/helpers/createClass","@babel/runtime-corejs3/helpers/defineProperty","@babel/runtime-corejs3/regenerator","@babel/runtime-corejs3/core-js-stable/set-timeout","@babel/runtime-corejs3/core-js-stable/promise","@babel/runtime-corejs3/core-js-stable/instance/slice","@babel/runtime-corejs3/core-js-stable/object/get-own-property-names","@babel/runtime-corejs3/helpers/asyncToGenerator","@babel/runtime-corejs3/core-js-stable/instance/splice","@babel/runtime-corejs3/core-js-stable/instance/index-of","@babel/runtime-corejs3/helpers/toConsumableArray","@babel/runtime-corejs3/core-js-stable/map","@babel/runtime-corejs3/core-js-stable/instance/bind","@babel/runtime-corejs3/core-js-stable/object/create"],t):(e=e||self).sandbox=t(e._forEachInstanceProperty,e._concatInstanceProperty,e._classCallCheck,e._createClass,e._defineProperty,e._regeneratorRuntime,e._setTimeout,e._Promise,e._sliceInstanceProperty,e._Object$getOwnPropertyNames,e._asyncToGenerator,e._spliceInstanceProperty,e._indexOfInstanceProperty,e._toConsumableArray,e._Map,e._bindInstanceProperty,e._Object$create)}(this,(function(_forEachInstanceProperty,_concatInstanceProperty,_classCallCheck,_createClass,_defineProperty,_regeneratorRuntime,_setTimeout,_Promise,_sliceInstanceProperty,_Object$getOwnPropertyNames,_asyncToGenerator,_spliceInstanceProperty,_indexOfInstanceProperty,_toConsumableArray,_Map,_bindInstanceProperty,_Object$create){"use strict";_forEachInstanceProperty=_forEachInstanceProperty&&Object.prototype.hasOwnProperty.call(_forEachInstanceProperty,"default")?_forEachInstanceProperty.default:_forEachInstanceProperty,_concatInstanceProperty=_concatInstanceProperty&&Object.prototype.hasOwnProperty.call(_concatInstanceProperty,"default")?_concatInstanceProperty.default:_concatInstanceProperty,_classCallCheck=_classCallCheck&&Object.prototype.hasOwnProperty.call(_classCallCheck,"default")?_classCallCheck.default:_classCallCheck,_createClass=_createClass&&Object.prototype.hasOwnProperty.call(_createClass,"default")?_createClass.default:_createClass,_defineProperty=_defineProperty&&Object.prototype.hasOwnProperty.call(_defineProperty,"default")?_defineProperty.default:_defineProperty,_regeneratorRuntime=_regeneratorRuntime&&Object.prototype.hasOwnProperty.call(_regeneratorRuntime,"default")?_regeneratorRuntime.default:_regeneratorRuntime,_setTimeout=_setTimeout&&Object.prototype.hasOwnProperty.call(_setTimeout,"default")?_setTimeout.default:_setTimeout,_Promise=_Promise&&Object.prototype.hasOwnProperty.call(_Promise,"default")?_Promise.default:_Promise,_sliceInstanceProperty=_sliceInstanceProperty&&Object.prototype.hasOwnProperty.call(_sliceInstanceProperty,"default")?_sliceInstanceProperty.default:_sliceInstanceProperty,_Object$getOwnPropertyNames=_Object$getOwnPropertyNames&&Object.prototype.hasOwnProperty.call(_Object$getOwnPropertyNames,"default")?_Object$getOwnPropertyNames.default:_Object$getOwnPropertyNames,_asyncToGenerator=_asyncToGenerator&&Object.prototype.hasOwnProperty.call(_asyncToGenerator,"default")?_asyncToGenerator.default:_asyncToGenerator,_spliceInstanceProperty=_spliceInstanceProperty&&Object.prototype.hasOwnProperty.call(_spliceInstanceProperty,"default")?_spliceInstanceProperty.default:_spliceInstanceProperty,_indexOfInstanceProperty=_indexOfInstanceProperty&&Object.prototype.hasOwnProperty.call(_indexOfInstanceProperty,"default")?_indexOfInstanceProperty.default:_indexOfInstanceProperty,_toConsumableArray=_toConsumableArray&&Object.prototype.hasOwnProperty.call(_toConsumableArray,"default")?_toConsumableArray.default:_toConsumableArray,_Map=_Map&&Object.prototype.hasOwnProperty.call(_Map,"default")?_Map.default:_Map,_bindInstanceProperty=_bindInstanceProperty&&Object.prototype.hasOwnProperty.call(_bindInstanceProperty,"default")?_bindInstanceProperty.default:_bindInstanceProperty,_Object$create=_Object$create&&Object.prototype.hasOwnProperty.call(_Object$create,"default")?_Object$create.default:_Object$create;var Global=function(){function e(){_classCallCheck(this,e),_defineProperty(this,"_debugMode",void 0),this._debugMode=!1}return _createClass(e,[{key:"debug",get:function(){return this._debugMode},set:function(e){this._debugMode=e}}]),e}(),global=new Global;function safeLog(){try{var e;(e=console).log.apply(e,arguments)}catch(e){console.warn(e)}}function isClass(e){if("function"!=typeof e)return!1;if(void 0===e.prototype)return!1;if(e.prototype.constructor!==e)return!1;if(_Object$getOwnPropertyNames(e.prototype).length>=2)return!0;var t=String(e);if("class"==_sliceInstanceProperty(t).call(t,0,5))return!0;if(/^function\s*\(|^function anonymous\(/.test(t))return!1;var r=/(call|apply|_classCallCheck)\(this(, arguments)?\)|\bthis(.\S+|\[.+?\])\s*(=|\()|=\s*this[,;]/.test(t);return!(!/^function\s+[A-Z]/.test(t)||!(r||/\[native code\]/.test(t)&&"BigInt"!==e.name&&"Symbol"!==e.name))||!(!r||"default_1"!==e.name)}function hackTimer(e){var t=e.setInterval,r=e.setTimeout,n=[],o=[];return{hookSetInterval:function(e,r){for(var n,a=arguments.length,c=new Array(a>2?a-2:0),s=2;s<a;s++)c[s-2]=arguments[s];var l=t.apply(void 0,_concatInstanceProperty(n=[e,r]).call(n,c));return o.push(l),global.debug&&safeLog("Call setInterval. intervalId: ".concat(l)),l},hookSetTimeout:function(e,t){for(var o,a=arguments.length,c=new Array(a>2?a-2:0),s=2;s<a;s++)c[s-2]=arguments[s];var l=r.apply(void 0,_concatInstanceProperty(o=[e,t]).call(o,c));return n.push(l),global.debug&&safeLog("Call setTimeout. timerId: ".concat(l)),l},reset:function(){_forEachInstanceProperty(n).call(n,(function(t){e.clearTimeout(t),global.debug&&safeLog("ClearTimeout. timerId: ".concat(t))})),_forEachInstanceProperty(o).call(o,(function(t){e.clearInterval(t),global.debug&&safeLog("ClearInterval. intervalId: ".concat(t))}))}}}function hackEventListener(e){var t=e.addEventListener,r=e.removeEventListener,n=new _Map,o=function(t,o,a){var c,s=n.get(t);(s&&s.length&&-1!==_indexOfInstanceProperty(s).call(s,o)&&_spliceInstanceProperty(s).call(s,_indexOfInstanceProperty(s).call(s,o),1),global.debug)&&safeLog(_concatInstanceProperty(c="Call removeEventListener. eventName: ".concat(t,"; eventHandler: ")).call(c,o?o.toString():"null"));return r.call(e,t,o,a)};return{hookAddEventListener:function(r,o,a){var c,s,l=n.get(r)||[];(n.set(r,_concatInstanceProperty(c=[]).call(c,_toConsumableArray(l),[o])),global.debug)&&safeLog(_concatInstanceProperty(s="Call addEventListener. eventName: ".concat(r,"; eventHandler: ")).call(s,o?o.toString():"null"));return t.call(e,r,o,a)},hookRemoveEventListener:o,reset:function(){_forEachInstanceProperty(n).call(n,(function(e,t){var r;return _forEachInstanceProperty(r=_toConsumableArray(e)).call(r,(function(e){return o(t,e)}))}))}}}function createSandbox(e){var t,r=new _Map,n=new _Map,o=new _Map,a=e,c=_Object$create(null);return{sandbox:new Proxy(c,{get:function(e,r){if(t){var n=t(a,r);if(void 0!==n)return n}var o=a[r];return"function"!=typeof o||isClass(o)||(o=_bindInstanceProperty(o).call(o,a)),o},set:function(t,c,s){if(n.has(c)?n.set(c,s):o.has(c)?o.set(c,s):Object.prototype.hasOwnProperty.call(a,c)?(r.set(c,a[c]),o.set(c,s)):n.set(c,s),a[c]=s,global.debug){var l,i="";e instanceof Window?i="window":e instanceof Document?i="document":e instanceof HTMLElement&&(i=e.tagName),safeLog("Set ",_concatInstanceProperty(l="".concat(i,".")).call(l,c.toString()," to "),s,"! Original value is ",r.get(c))}return!0},has:function(e,t){return t in a}}),reset:function(){_forEachInstanceProperty(n).call(n,(function(e,t){delete a[t]})),_forEachInstanceProperty(o).call(o,(function(e,t){a[t]=r.get(t)})),n.clear(),o.clear(),r.clear()},setGetProperty:function(e){t=e}}}var index={set debug(e){global.debug=e},create:function create(source){var windowProxy=createSandbox(window),timerWatcher=hackTimer(window),eventWatcherOfWindow=hackEventListener(window),eventWatcherOfDocument=hackEventListener(window.document),eventWatcherOfBody=hackEventListener(window.document.body);return windowProxy.setGetProperty((function(e,t){return"top"===t||"window"===t||"self"===t?windowProxy.sandbox:"setInterval"===t?timerWatcher.hookSetInterval:"setTimeout"===t?timerWatcher.hookSetTimeout:"addEventListener"===t?eventWatcherOfWindow.hookAddEventListener:"removeEventListener"===t?eventWatcherOfWindow.hookRemoveEventListener:"Promise"===t?e.Promise:"Object"===t?e.Object:void 0})),windowProxy.sandbox.document.addEventListener=eventWatcherOfDocument.hookAddEventListener,windowProxy.sandbox.document.removeEventListener=eventWatcherOfDocument.hookRemoveEventListener,windowProxy.sandbox.document.body.addEventListener=eventWatcherOfBody.hookAddEventListener,windowProxy.sandbox.document.body.removeEventListener=eventWatcherOfBody.hookRemoveEventListener,{mount:function mount(){var wrapperFunction=function wrapperFunction(window,setInterval,setTimeout){return eval(source)};return wrapperFunction.call(windowProxy.sandbox,windowProxy.sandbox,timerWatcher.hookSetInterval,timerWatcher.hookSetTimeout)},mountWithCommonjs:function mountWithCommonjs(module,exports,require){var wrapperFunction=function wrapperFunction(window,setInterval,setTimeout,module,exports,require){eval(source)};wrapperFunction.call(windowProxy.sandbox,windowProxy.sandbox,timerWatcher.hookSetInterval,timerWatcher.hookSetTimeout,module,exports,require)},unmount:function(){var e;_forEachInstanceProperty(e=[windowProxy,timerWatcher,eventWatcherOfWindow,eventWatcherOfDocument,eventWatcherOfBody]).call(e,(function(e){e.reset()}))}}}};return index}));
